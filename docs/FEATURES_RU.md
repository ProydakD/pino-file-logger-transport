# Возможности

[English](FEATURES.md) | [Русский](FEATURES_RU.md)

## Запись логов в файлы

Транспорт записывает логи в файлы с поддержкой настраиваемой директории и имени файла.

### Конфигурация
```javascript
const transport = pino.transport({
  target: 'pino-file-logger-transport',
  options: {
    logDirectory: './logs',  // Обязательный параметр
    filename: 'app',         // Опционально, по умолчанию 'log'
  },
});
```

## Ротация логов

Автоматическая ротация логов по календарной дате.

### Как работает
- При смене календарной даты создается новый файл
- Старый файл закрывается
- Новые логи записываются в файл текущей даты

### Формат имени файла
```
filename-YYYY-MM-DD.log
```

Пример:
```
app-2025-09-23.log
app-2025-09-24.log
```

## Управление хранением логов

Настройка срока хранения логов.

### Конфигурация
```javascript
const transport = pino.transport({
  target: 'pino-file-logger-transport',
  options: {
    logDirectory: './logs',
    retentionDays: 30,  // Хранить логи 30 дней
  },
});
```

### Как работает
- При инициализации транспорта удаляются файлы старше `retentionDays`
- При ротации (если включено) также удаляются старые файлы

## Архивация логов

Автоматическая архивация старых логов.

### Поддерживаемые форматы
- **ZIP** - стандартный формат с хорошим сжатием
- **GZIP (tar.gz)** - формат с совместимостью Unix
- **TAR** - несжатый архив для максимальной скорости
- **None** - отключение архивации

### Конфигурация
```javascript
const transport = pino.transport({
  target: 'pino-file-logger-transport',
  options: {
    logDirectory: './logs',
    archiveFormat: 'zip',        // Формат архива
    compressionLevel: 6,          // Уровень сжатия (0-9)
    archiveDirectory: './archives', // Отдельная директория для архивов
  },
});
```

### Когда происходит архивация
1. При закрытии транспорта (по умолчанию)
2. При ротации логов (опционально, через `archiveOnRotation: true`)

## Фильтрация по уровню логов

Запись только логов определенного уровня и выше.

### Конфигурация
```javascript
const transport = pino.transport({
  target: 'pino-file-logger-transport',
  options: {
    logDirectory: './logs',
    level: 'warn',  // Записывать только warn и выше (error, fatal)
  },
});
```

### Поддерживаемые уровни
- `silent` - не писать ничего
- `fatal` - только фатальные ошибки
- `error` - ошибки и фатальные ошибки
- `warn` - предупреждения, ошибки и фатальные ошибки
- `info` - информационные сообщения и выше (по умолчанию)
- `debug` - отладочные сообщения и выше
- `trace` - трассировочные сообщения и выше

## Буферизация для производительности

Оптимизация производительности через буферизацию записей.

### Конфигурация
```javascript
const transport = pino.transport({
  target: 'pino-file-logger-transport',
  options: {
    logDirectory: './logs',
    bufferSize: 50,     // Размер буфера
    flushInterval: 500, // Интервал сброса в миллисекундах
  },
});
```

### Как работает
- Логи собираются в буфере
- Буфер записывается в файл при достижении `bufferSize`
- Буфер записывается по таймеру `flushInterval`
- Оставшиеся логи записываются при закрытии транспорта

## Обработка ошибок

Надежная обработка ошибок файловой системы.

### Как работает
- Ошибки записи не приводят к падению приложения
- Резервная запись в консоль при проблемах с файлами
- Логирование всех ошибок для диагностики
- Продолжение работы при недоступности директории